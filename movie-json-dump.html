<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Favorite Movies</title>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400i" rel="stylesheet">
  <style type="text/css">    
    button,
    div,
    form,
    input {
      margin: 10px;
    }
    
    .jumbotron>hr {
    border-top-color: #4d2727;
    }
    .button-movie {
      margin : 5px;
    }

    .my-4 {
      background: red;
    }

    p {
      margin-top: 10px;
      font-family: 'Roboto', sans-serif;
    }
  </style>
</head>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script type="text/javascript">

$(document).ready(function() {

  $("#find-movie").on("click", function(event) {
    
    event.preventDefault();
    // Here we grab the text from the input box
    var movie = $("#movie-input").val();

    // Here we construct our URL
    var queryURL = "https://www.omdbapi.com/?t=" + movie + "&y=&plot=short&apikey=trilogy";

    // Write code between the dashes below to hit the queryURL with $ajax, then take the response data
    // and display it in the div with an id of movie-view

    // YOUR CODE GOES IN THESE DASHES. DO NOT MANUALLY EDIT THE HTML ABOVE
    $.ajax({
        url : queryURL,
        method : 'GET'
      }
    ).then(function(resp) {
      
      console.log(resp);
      
      //var jsonStr = JSON.stringify(resp);
      //$("#movie-view").append(jsonStr);
      //var title = resp.Title;

      addMovie(resp);
      $("#movie-input").val(""); // clear the text in search box

    })
    .catch(function(err){
      console.error(err)
    })        
  }); 

  function addMovie(resp){
      
      var title = $("<h2><strong>" + resp.Title + "</strong></h2>");
      var year = $("<div><strong>Year: " + resp.Year + "</strong></h2>");
      var rated = $("<div><strong>Rated: " + resp.Rated + "</strong></h2>");
                
      var poster = $("<img>").attr("src", resp.Poster);
      
      var plot = $("<p>" + resp.Plot + "</p>");

      //var plot = $("<p>").text(resp.Plot);
      var button = $("<button class='btn btn-primary btn-lg button-movie'>" + resp.Title + "</button>");
      var divider = $("<hr class='my-4' />");          
      $("#movie-view").append(title, year, rated, poster, plot, divider);
      $(".moviebutton").append(button);
    }
}) 
</script>

<body>
  <div class="container">
    <div class="jumbotron">
      <h1 class="display-3 text-center">Movie Search</h1>
      <p class="lead text-center moviebutton"></p>
      <hr class="my-4">
      <form>
        <div class="form-group">
          <label for="movie-input">Movie Title</label>
          <input id="movie-input" type="text" class="form-control" placeholder="Enter title" required>          
        </div>
        <button type="submit" class="btn btn-primary" id="find-movie">Search</button>
      </form>

      <div class="text-center" id="movie-view"></div>
    </div>
  </div>
</body>
</html>